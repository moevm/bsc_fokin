{% macro render_navigation(pagination, endpoint) %}
<div class="pagination">
	{% for page in pagination.iter_pages() %}
	{% if page %}
	{% if page != pagination.page %}
	<a class="btn btn-info mr-2" href="{{ url_for(endpoint, page=page) }}">{{ page }}</a>
	{% else %}
	<a class="btn btn-outline-info mr-2" href="{{ url_for(endpoint, page=page) }}">{{ page }}</a>
	{% endif %}
	{% else %}
	<a class="btn btn-outline-info disabled mr-2" href="">...</a>
	{% endif %}
	{% endfor %}
</div>
{% endmacro %}


{% macro render_comment_list(comment_list) %}
<div class="row">
	<div class="col-8">
		{% for comment in comment_list.items %}
		<div class="card border-secondary mb-3">
			<div class="row no-gutters">
				<div class="col-3">
					<div class="card-body">
						<ul class="list-group list-group-flush">
							<li class="list-group-item">
								<img src="{{ comment.user.avatar_url }}" class="card-img-top">
							</li>
							<li class="list-group-item"> {{ comment.user.full_name }}</li>
							<li class="list-group-item"> Прогресс курса:
								<div class="progress">
									<div class="progress-bar" role="progressbar"
										style="width: {{ "%.2f" % (comment.user.courses[comment.course.stepic_id | string].score / comment.course.score * 100) }}%"
										aria-valuenow="{{ "%.2f" % (comment.user.courses[comment.course.stepic_id | string].score / comment.course.score * 100) }}"
										aria-valuemin="0"
										aria-valuemax="{{ comment.course.score }}">
										{{ "%.2f" % (comment.user.courses[comment.course.stepic_id | string].score / comment.course.score * 100) }}%
									</div>
								</div>
							</li>
							<li class="list-group-item">
								<span class="badge badge-success"> Лайки: {{ comment.epic_count }}</span>
								<span class="badge badge-danger"> Дизлайки: {{ comment.abuse_count }}</span>
							</li>
							<li class="list-group-item"> Ответы: {{ comment.reply_count }}</li>
							<li class="list-group-item"> Репутация: {{ comment.user.reputation }}</li>
							<li class="list-group-item">
								{% if comment.user.courses[comment.course.stepic_id | string].steps[comment.step_id | string].is_passed  %}
								<span class="badge badge-success"> Степ пройден.
									{% else %}
									<span class="badge badge-danger"> Степ не пройден.
										{% endif %}
										Попытки: {{ comment.user.courses[comment.course.stepic_id | string].steps[comment.step_id | string].total_submissions }}
									</span>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-9">
					<div class="card-header">
						{{ comment.time | date('%d.%m.%Y %H:%M') }}
					</div>
					<div class="card-body">
						<p class="card-text">
							{{ comment.text | safe }}
						</p>
					</div>
				</div>
				<div class="card-footer">
					<a href="#" class="btn btn-outline-primary">Ссылка на обсуждение</a>
				</div>
			</div>
		</div>
		{% endfor %}
	</div>
</div>
{% endmacro %}


{% macro render_comment_list_filter(current_user, sort_select_list, order_select_list) %}
<div class="">
	<form action="{{ url_for('main.update_comments_filtration') }}" method="post">
		<div class="row">
			<div class="col-10 row">
				{% for filter in current_user.filter_list %}
					<div class="col">
						<div class="form-group">
							<legend class="col-form-label"> Параметр №{{ loop.index }} </legend>
								<div class="form-check">
									<select name="sorting_{{ loop.index }}" class="form-control">
										{% for option in sort_select_list %}
											<option value="{{ option.value }}" {% if filter.sort == option.value %} selected {% endif %}> {{ option.label }} </option>
										{% endfor %}
									</select>
								</div>
						</div>
						<div class="form-group">
							<legend class="col-form-label"> Порядок </legend>
							<div class="form-check">
								<select name="ordering_{{ loop.index }}" class="form-control">
									{% for option in order_select_list %}
										<option value="{{ option.value }}" {% if filter.order == option.value %} selected {% endif %}> {{ option.label }} </option>
									{% endfor %}
								</select>
							</div>
						</div>
					</div>
				{% endfor %}
			</div>
			<div class="col-2">
				<div class="form-group">
					<button type="submit" class="btn btn-success">Применить</button>
				</div>
				<a class="btn btn-warning ml-auto" href="{{ url_for('main.update_comments') }}">Обновить</a>
			</div>
		</div>
	</form>
</div>
{% endmacro %}
